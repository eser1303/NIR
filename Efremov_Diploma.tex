\documentclass[12pt]{article} %,fleqn
\usepackage{Diplo}

\usepackage[left=3cm,right=1.5cm,
top=2cm,bottom=2cm]{geometry}

\usepackage{comment}
\usepackage{hyperref}
\newtheorem{definition}{Определение}
\newtheorem{theorem}{Теорема}
\newtheorem{utv}{Утверждение}

\graphicspath{{../pics/}}


\begin{document}
	
\vskip 3mm

\setcounter{page}{1}
%%%%%%%% Титульный лист %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{center}
	\thispagestyle{empty}
	
	{ Министерство науки и высшего образования Российской Федерации\\}

	
	
	{ Московский Физико-технический институт \\}
	
	{ (Государственный Университет) \\}
	
	{ Факультет управления и прикладной математики  \\}
	
	{ Кафедра Интеллектуальных систем\\}
	
	{при Вычислительном Центре им. А.А.Дородницына РАН\\ [4cm]}
	
	{ \bf \Large Выпускная квалификационная работа\\}
	
	{ \bf \Large{"Разработка метода выделения века как параметрической кривой на изображении глаза"\\[1cm]} }
	
	{\bf {Студента 4-го курса Ефремова Сергея Владимировича}\\[3cm]}
	
\end{center}

\begin{flushright}
	\bf{Научный руководитель}\\
	\bf{д-р техн. наук Матвеев И. А.}\\[4cm]
\end{flushright}


\begin{center}
	Москва, 2020
\end{center}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\begin{abstract}
	{}
	

\end{abstract}

\newpage
\tableofcontents
 


\newpage
\section{Введение}

Благодаря стремительному развитию технологий, с каждым днём все больше расширяется сфера практического применения технических средств цифровой обработки изображений. При этом относительно новым направлением стала разработка методов распознавания личности на основе человеческого глаза. Идентификация личности человека по радужке – перспективное направление развития, которое может быть использовано в системах контроля доступа. 

Интересно то, что эта идея не нова, так, еще в 1936 году офтальмологи \cite{Medic} предложили использовать для этих целей радужную оболочку глаза (рис.~\ref{fig:glaz}). Далее исследователями всего мира разрабатывались различные методы распознавания человека по его радужной оболочке, но по-настоящему сильный рост интереса к идентификации произошел только в начале XXI века. Это объяснялось качественными изменения условий жизнь общества: эволюция средств регистрирования и обработки изображений, необходимость распознавания личности в связи с террористической угрозой\cite{Conf3, Terr, Tech}. 

\begin{figure}[h]
	
	\centering
	
	\includegraphics[width=0.6\linewidth]{glaz.jpg}
	
	\caption{Внешнее строение глаза}
	
	\label{fig:glaz}
	
\end{figure}

Однако получить качественное и обособленное изображение радужки на практике становится не так просто, и важной задачей оказывается необходимость корректно определять границы глаза, задаваемые веками. Исследования в этом направлении породили различные модели, которые также используют в биометрических системах распознавания личности. 

На сегодняшний день можно с уверенностью говорить о том, что биометрические технологии идентификации личности плотно вошли в нашу жизнь и используются во всех сферах человеческой деятельности, в том числе и в системах контроля. Так, существует целый ряд биометрических модальностей, позволяющих идентифицировать человека: рисунок папиллярных линий пальца, радужка глаза, походка, голос, почерк. Такое разнообразие методов объясняется тем, что при богатстве потенциальных сценариев использования биометрических модальностей, каждая из них может быть использована по-разному для аутентификации пользователя. Например, применение биометрических технологий уже активно осуществляется при проведении платежных операций в банковской сфере, особо нуждающейся в защите данных. Здесь они заменяют уже ставшие традиционными методы идентификации пользователей: ПИН-коды, пароли и т.д. Однако, биометрические технологии имеют широкую перспективу использования, так как обладают целым рядом неоспоримых преимуществ. Среди которых можно выделить невозможность кражи ключа без ведома его обладателя.

Использование биометрических систем настолько плотно вошло в нашу жизнь, что обыватель даже не замечает, как часто и повсеместно ими пользуется. Так, в частности, для разблокировки мобильных устройств, применяется отпечаток пальца, снимок лица или радужки. Еще одним преимуществом биометрических систем, в частности идентификации человека по его радужной оболочке, считается удобство взаимодействия с ними пользователя. Эффективность работы систем основывается на способности обработки поступающих в них данных с учетом изменчивости состояния и условий окружающей среды. То есть, даже в случае значительных искажений параметров входящих данных, в связи с изменчивостью состояний (например, ухудшение условий освещенности, затемнение ресницами, отвод взгляда), системы биометрической идентификации, использующие изображения глаза, должны выдавать корректный результат и аутентифицировать пользователя адекватно. Также неоспоримо важным фактором для эффективности систем такого рода, является необходимость работы в условиях ограниченности не только вычислительных ресурсов, но и времени, требующегося на распознание.
Однако хотелось бы отметить, что обработка изображения радужки необходима не только для идентификации человека, но и применяется в медицинских целях, что еще больше подчеркивает необходимость и важность получения корректной информации. 

\newpage
В связи со всем вышеперечисленным, в ходе данного исследования был разработан метод выделения века как параметрической кривой на изображении глаза. Представленный метод основан на том, что параметры искомой кривой определяются с помощью максимизации суммы вертикального градиента яркости, рассматриваемого в окрестности века. Стоит учитывать, что большинство, существовавших ранее методов, основывались на определении полной границы века или границы радужки целиком, но ни один из них не предлагал осуществлять обработку в несколько этапов, как в данной работе.
 

\newpage
\subsection{Цели и задачи работы}

\textbf{Цель и задачи исследования.} Основной целью исследования является построение модели, позволяющей определять коэффициенты параболы, задающей положение верхнего века и улучшить качество выделения по сравнению с существующими моделями. Для реализации этой цели были поставлены следующие задачи:
\begin{itemize}
	\item Изучить существующие подходы к решению задачи выделения века на изображении глаза.
	\item Изучить существующие алгоритмы решения этой задачи.
	\item Провести предобработку данных.
	\item Реализовать алгоритмическую часть модели, построенной на идее оптимизации и градиентного анализа.
	\item Модернизировать модель определения крайней точки века с помощью многонаправленного двумерного (2D) фильтра Габора и метода скользящего окна. 
	\item Реализовать модернизированную модель и сравнить полученные результаты с существующими алгоритмами.
\end{itemize}

\bigskip

\textbf{Научная новизна.} Используется принципиально новый подход к определению коэффициентов квадратичной параболы, задающей веко, с помощью оптимизации градиентного функционала.

\bigskip

\textbf{Методы исследования.} Алгоритмы реализованы на языке программирования C++ с использованием библиотеки OpenCV~3.4.

\bigskip

\textbf{Практическая ценность.} Полученная модель может быть использована в качестве встраиваемого модуля. Например, с её помощью можно
\begin{enumerate}
	\item Фиксировать границы зрачка глаза для последующей идентификации личности по радужке с более точным результатом.
	\item Дополнять существующие биометрические системы с помощью идентификации не только радужки испытуемого, но и линии века, получая более высокое качество распознавания.
\end{enumerate}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newpage
\section{Определения и обозначения}

\subsection{Основные определения и понятия}

\textcolor{red}{Возможно блок лишний и его стоит убрать?}

\textcolor{red}{Какого рода терминологию сюда стоило бы включить?}

\subsection{Постановка задачи}
\textcolor{red}{Оставлю пока это тут.}

\textcolor{red}{
	В процессе исследования предлагается в начале определить одну точку верхнего века, а затем на основании этой точки изучать её окрестность и подбирать параметрические коэффициенты, исследуя оптимизируемый функционал. Точка, о которой идет речь обозначена на рис.~\ref{fig:glaz2} литерой $V$.
	Метод дает возможность выявить положение верхнего века после определения положения зрачка, причём с высокой точностью. В связи с тем, что он отличается высокой скоростью работы и устойчивостью, возможно его применение в широком круге систем биометрической аутентификации.}

\begin{figure}[h]
	
	\centering
	
	\includegraphics[width=0.6\linewidth]{glaz2.jpg}
	
	\caption{Положение век. V и N~--- точки, соответствующие положениям верхнего и нижнего век соотвественно, Z~--- центр зрачка}
	
	\label{fig:glaz2}
	
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\section{Обзор существующих методов}

\subsection{Методы выделения контуров}

Практически все методы выделения контуров основываются на разрывности сигнала яркости. Наиболее общим способом поиска перепадов яркостей является обработка изображения методом скользящего окна, называемого в разной литературе также маской, фильтром, ядром или шаблоном. Оно представляет из себя некую прямоугольную матрицу, накладываемую на группу пикселей исходного изображения. Элементы такой матрицы называют коэффициентами, а разного рода преобразования над ней~--- фильтрацией или пространственной фильтрацией(рис.~\ref{fig:prost_filt}).

\begin{figure}[h]
	
	\centering
	
	\includegraphics[width=0.7\linewidth]{prost_filt.jpg}
	
	\caption{Схема пространственной фильтрации}
	
	\label{fig:prost_filt}
	
\end{figure}

\newpage

Процесс основан на перемещении фильтра от точки к точке, вычисляя отклик для каждой из них. Для случая линейной пространственной фильтрации значение задается суммой произведения коэффициентов маски на соотвествующие значения яркостей в точках, покрытых маской. Так, для квадратной маски размерности $3\times3$ отклик $R$ линейной фильтрации в точке $(x, y)$ изображения на рис.~\ref{fig:prost_filt} определится как сумма произведений значений маски на значнения пикселей под маской:
\begin{gather}\label{3.1}
R = w(-1,-1)f(x-1, y-1) + w(-1,0)f(x-1,y)+\dots +w(0,0)f(x,y)+\dots \notag\\
+ w(1,0)f(x+1, y)+w(1,1)f(x+1, y+1)
\end{gather}

\subsubsection{Производные 1-го и 2-го порядков}

Для определения направления и величины перепада яркости чаще всего применяют градиент изображения $\bigtriangledown \mathbf{f}$, определяемый в точке $(x,y)$ как вектор:
\begin{gather}\label{grad}
	\bigtriangledown \mathbf{f} \equiv \text{grad}(f)\equiv
	\begin{bmatrix} g_x \\ g_y \end{bmatrix}=
	\begin{bmatrix} \frac{\partial f}{\partial x} \\ \frac{\partial f}{\partial y}
	\end{bmatrix}
\end{gather}

Важным геометрическим свойством градиента является тот факт, что его направление совпадает с направлением максимальной скорости изменения функции f в точке $(x, y)$. Направление вектора градиента задается углом между направлением вектора $\bigtriangledown \mathbf{f}$ и осью~$x$:
\begin{gather}\label{grad_alpha}
	\alpha(x, y) = \text{arctg}\left(\frac{g_y}{g_x}\right)
\end{gather}

Направление контура в произвольной точке $(x,y)$ таким образом получается перпендекулярно направлению $\alpha(x,y)$ вектора градиента в этой точке(рис.~\ref{fig:grad}).


\begin{figure}[h]
	
	\centering
	
	\includegraphics[width=0.7\linewidth]{grad.jpg}
	
	\caption{Применение градиента для нахождения границ контуров на изображении}
	
	\label{fig:grad}
	
\end{figure}

\newpage

При работе с изображениями функция яркости имеет дискретную природу, поэтому вместо производных первого и второго порядка используются их дискретные аналоги.

Первая производная одномерной функции может быть задана как разность значений соседних элементов:
\begin{gather}\label{first}
	\frac{\partial f}{\partial x}=
	f(x+1) - f(x)
\end{gather}

Аналогично вторая производная определяется как разность соседних значений первой производной:
\begin{gather}\label{second}
	\frac{\partial^2 f}{\partial^2 x}=
	f(x+1) + f(x-1) -2f(x)
\end{gather}

Нетрудно заметить, что по факту эти преобразования задают максимально простые маски фильтрации:
\ref{grad_mask}-$a$ для первой производной вертикальной компоненты и \ref{grad_mask}-$b$~--- для второй.
\begin{gather}\label{grad_mask}
	\begin{bmatrix} w(x,y)=-1 \\ w(x+1,y)=1 \end{bmatrix}
	~~~~~~~~~~~~~~~~~~~~
	\begin{bmatrix} 
	w(x-1,y)=1 \\ w(x,y)=-2 \\ w(x+1,y)=1 \\
	\end{bmatrix}\\
a~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~b\notag
\end{gather}

Однако, способ дискретно приблизить производную, описанный выше не единственный. Так, можно, например, использовать маски размером $3\times3$. Далее описаны другие вариации градиентных операторов.

\subsubsection{Оператор Робертса}

Обозначим область изображения размером $3\times 3$ и значения яркостей к жадой из ее точек в соответствии с рис.~\ref{fig:grad_mask_3}

\begin{figure}[h]
	
	\centering
	
	\includegraphics[width=0.2\linewidth]{grad_mask_3.jpg}
	
	\caption{Яркости в области $3\times3$ на изображении}
	
	\label{fig:grad_mask_3}
	
\end{figure}

Один из возможных способов нахождения первых частных производных в точке~$z_5$ состоит в применении перекрестного оператора Робертса:
\begin{gather}\label{grad_mask_3}
	g_x = \frac{\partial f}{\partial x} = (z_9-z_5)\\
	g_y = \frac{\partial f}{\partial y} = (z_8-z_6)
\end{gather}

Такое преобразование задает маски фильтрации на рис.~\ref{fig:grad_mask_rob} соотвественно.

\begin{figure}[h]
	
	\centering
	
	\includegraphics[width=0.25\linewidth]{grad_mask_rob.jpg}
	
	\caption{Маски оператора Робертса}
	
	\label{fig:grad_mask_rob}
	
\end{figure}

Основным преимуществом данного градиентного оператора является высокая скрость обработки изображения, но зачастую устойчивость оставляет желать лучшего. 

\subsubsection{Оператор Превитта}

Используем обозначения рис.~\ref{fig:grad_mask_3}. Тогда оператор Превитта может быть задан выражениями:
\begin{gather}\label{grad_mask_prev}
	g_x = \frac{\partial f}{\partial x} = (z_7+z_8+z_9)-(z_1+z_2+z_3)\\
	g_y = \frac{\partial f}{\partial y} = (z_3+z_6+z_9)-(z_1+z_4+z_7)
\end{gather}

Маска этого градиентного оператора имеет вид, изображенный на рис.~\ref{fig:grad_mask_prev}.

\subsubsection{Оператор Собеля}

Небольшое видоизменение формул ~\ref{grad_mask_prev} в виде использования весового коэффициента~$2$ для средних элементов, позволяет уменьшить эффект сглаживания для функции градиента:
\begin{gather}\label{grad_mask_sob}
	g_x = \frac{\partial f}{\partial x} = (z_7+2z_8+z_9)-(z_1+2z_2+z_3)\\
	g_y = \frac{\partial f}{\partial y} = (z_3+2z_6+z_9)-(z_1+2z_4+z_7)
\end{gather}

\newpage

Маски, используемые оператором Собеля, отображены на рис.~\ref{fig:grad_mask_sob}.

\begin{figure}[h]
	
	\centering
	
	\includegraphics[width=0.4\linewidth]{grad_mask_sob.jpg}
	
	\caption{Маски оператора Превитта}
	
	\label{fig:grad_mask_sob}
	
\end{figure}

Стоит отметить, что у каждой из градиентных масок, описанных выше, сумма весовых коэффициентов равна нулю, то есть эти операторы будут давать нулевой отклик на областях постоянной яркости, как и следовало ожидать от дифференциального оператора.

\subsubsection{Преобразование Хафа}

Рассмотренные выше методы применимы, когда имеется дополнительная информация о местоположении исследуемых объектов на изображении. Зачастую таких данных нет и приходится исходить из заранее заданных глобальных свойств. Ниже изложен метод, основанный на выянении того, лежат ли множества пикселей на кривой заранее заданной формы.
Будем считать, что контур искомой кривой изначально имеет форму прямой, и воспользуемся преобразованием Хафа для ее поиска.
Рассмотрим точку~$(x_i, y_i)$ исходного изображения и общее уравнение прямой на плоскости:$y = ax+b$. Через точку~$(x_i, y_i)$ проходит бесконечное множество прямых, удовлетворяющих уравнению: $y_i = ax_i+b$. Перепишем это уравнение в виде:$b = x_i a - y_i$ и перейдем в координатную плоскость $ab$, называемую пространством параметров. Очевидно, что в нем для заданной пары~$(x_i, y_i)$ существует уравнение единственной прямой. Более того для каждой пары $(x_i, y_i)$,$(x_j, y_j)$ точек в исходном пространстве, в пространстве параметров существует единственная точка $(a', b')$, находящаяся на пересечении соотвествующих для точек прямых пространства параметров и задающая прямую, на которой лежат эти точки в исходном пространстве(рис.~\ref{fig:param_haf}).

\begin{figure}[h]
	
	\centering
	
	\includegraphics[width=0.6\linewidth]{param_haf.jpg}
	
	\caption{Исходная плоскость($xy$), Пространство параметров($ab$)}
	
	\label{fig:param_haf}
	
\end{figure}

Проблема использования такого перехода проявляется при попытке отобразить прямую близкую к вертикальной, так как ее угловой коэффициент $a$ стремится к бесконечности. Поэтому, чтобы обойти данную трудность прямую представляют с помощью нормали:
\begin{gather}\label{norm}
	x\cos{\Theta} + y\sin{\Theta} = \rho
\end{gather}

Геометрическую интерпретацию параметров~$\rho$~и~$\Theta$ можно увидеть на рис.~\ref{fig:norm}-а. Каждая синусоида на рис.~\ref{fig:norm}-б представляет семейство прямых, проходящих через конкретную точку $(x_k, y_k)$ на исходной плоскости $xy$. Точка перечения $(\rho'\Theta')$ на этом рисунке соответствует прямой, проходящей через точки $(x_i, y_i)$ и $x_j, y_j$ на рис.~\ref{fig:norm}-а.

\begin{figure}[h]
	
	\centering
	
	\includegraphics[width=0.8\linewidth]{norm.jpg}
	
	\caption{(а)~Представление прямой на исходной плоскости с помощью параметров нормали $(\rho, \Theta)$. 
	(б)~Синусоиды на плоскости $\rho \Theta$.
	(в)~Разбиение плоскости $\rho \Theta$ на ячейки накопления}
	
	\label{fig:norm}
	
\end{figure}

Осуществив преобразование Хафа, далее предлагается разбить пространство параметров $\rho \Theta$ на так называемые ячейки накопления, как показано на рис.~\ref{fig:norm}-в. Затем для каждой точки $(x_k, y_k)$ исходной плоскости перебираем возможные значения для параметра $\Theta$ и находим соотвествующее ему значение $\rho = x_k\cos{\Theta}+y_k\sin{\Theta}$. Если выбор значения $\Theta_p$ приводит к решению $\rho_q$, то увеличиваем значение ячейки $A(p,q)$ на 1. После выполнения этого алгоритма значение $A(p,q)=Q$ означает, что на исходной плоскости находится $Q$ точек лежащих на прямой $\rho_p = x_k\cos{\Theta_q}+y_k\sin{\Theta_q}$.
Отсюда и находят прямые контура. Аналогичным образом можно применять преобразование Хафа к любой функции вида $g(v,c) = 0$, где $v$~--- это вектор координат, а $c$~--- вектор коэффициентов.

\subsubsection{Интегро-дифференциальный оператор (IDO)}
\subsubsection{Оператор Кэнни}

\newpage

\subsection{Модели аппроксимации века}

\subsubsection{Эллиптический контур века}

\subsubsection{Параболический контур века}

\newpage
\subsection{Методы выделения века на изображении глаза}

В алгоритмах идентификации личности, использующих радужку, чаще всего начинают с опеределения границы радужка-склера \cite{Adam_1, Daugman, Matv} или нормализуют радужку (рис.~\ref{fig:glaz3}) \cite{Min}, а лишь только потом определяют границу века. Это приводит к необходимости выполнять большое количество дополнительных вычислений. Рассмотрим только те методы, в которых для детектирования века необходимо заранее определить не более чем положение зрачка или радужки.

\begin{figure}[h]
	
	\centering
	
	\includegraphics[width=0.8\linewidth]{glaz3.jpg}
	
	\caption{Определение положения века}
	
	\label{fig:glaz3}
	
\end{figure}

Мы можем определить два ключевых этапа в произвольном алгоритме детектирования века на изображении глаза, один из которых ~--- предобработка изображения, а второй~--- локализация века. Как правило, исследователи работают только над одним из этапов, в то время как второй заимствуют из уже ранее написанных работ, предлагая новые комбинации предобработка~-~локализация, которые ранее не были описаны в научной литературе. В данной работе мной проведена оценка существующих методов распознавания и ананлиз методик ранее не упоминавшихся в иcследовательских работах. Предложенный метод сравнивается с наиболее успешными комбинациями, демонстрирующими наиболее точный результат при тестировании.

\textcolor{red}{Планирую расписать этот блок поподробнее, пока просто внес коррективы}

Для нахождения границы века в~\cite{Wildes} предложено использовать в качестве первого шага выделение границ на изображении, а затем для локализации века~--- преобразование~Хафа. 

В \cite{Daugman} используется сглаживание изображения с применением фильтра Гаусса и интегродифференциальный оператор
(IDO) для того, чтобы найти контуры на изображении в том числе нижнее и верхнее веко.

Ещё один метод выделения века предложен в \cite{KKX}, так в работе для предообработки используется одномерный фильтр пиковой формы, хорошо удаляющий шум от ресниц, а для локализации IDO.

Интуитивно понятный метод изложен в \cite{Masek}. Его идея заключается в разделении области радужки и века горизонтальными прямыми, их положение вдоль вертикальной оси определялось значением максимального отклика после осуществления свертки изображения с использованием фильтра Собела. Эта же свертка применяется в \cite{KP} в сочетании с IDO. 

В исследованиях \cite{Adam_2, Adam_1} используется анизотропная диффузия для погашения шумов при предобработке, фильтр Собела для веделения границ и фильтр Хафа для параболлических кривых. 

Для выделения границ в \cite{Yang} предложен ассиметричный оператор Кэнни и для локилизации~--- аппроксимация параболической кривой с помощью МНК. 

В качестве одного из методов определения границ века также можно выделить метод адаптивных контуров, предложенный в работе \cite{Smirn}. Его основная идея~--- задать модель контура последовательностью точек и оптимизировать функционал на этом контуре, таким образом добиваясь его эволюции.

Почти все изложенные выше методы базируются на необходимости наличия дополнительных внешних условий или требований к качеству изображения, поэтому не всегда отличаются хорошей устойчивостью в условиях постоянно изменяющегося окружения. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newpage
\section{Описание модели}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newpage
\section{Реализация алгоритма}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newpage
\section{Результаты работы алгоритма}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newpage
\section{Заключение}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newpage

\bibliographystyle{plain}
\bibliography{mylib}
\nocite{Yang}

\end{document}